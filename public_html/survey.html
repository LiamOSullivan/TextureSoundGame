<!DOCTYPE html>
<!--
    Created on : 24-Oct-2016, 09:04:21
    Author     : Liam O'Sullivan

Sprint Backlog:
Load images on page load from directory, rather then creating large array?
Persistent storage: https://www.w3.org/TR/2009/WD-webstorage-20091222/

'Game level' 2Up, 3UP etc...

Record IP address of visitor.

Store list of images already displayed and skip/ allow n uses.

Add sound visualisation option- makes a difference to results?

Compare against performance of waveform display?


Product Backlog:
FW: Allow user modified sounds if they disagree, include ML to adapt future sounds.
-->
<html>
    <head>
        <title>The Texture-Sound Game!</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script></script>
        <link rel="stylesheet" type="text/css" href="texturegame.css">


    </head>
    <body>
        <div align="center">
            <H1>Click on the picture you think is making the sound!</H1>
            <br>
            <img width="200" height="200" id="leftPicture" alt="a texture image" style="border:2px groove grey" >
            <img width="200" height="200" id="rightPicture" alt="a texture image" style="border:2px groove grey" >
            <br>
        </div>
        <div align=center>

            <audio id="sound1" controls>
                <source  type="audio/mpeg" >
                <source  type="audio/wav" >
                Your browser does not support the audio element.
            </audio>

        </div>
        <form>
            <!-- fulfill HTML brief reqs here-->
        </form>
        <script>
            //JS code here...
            var nImages = 100;
            var imageArray = [];
            var soundArray = [];

            function imageClickEvent(n) {
                console.log(n.valueOf());
                checkChoice(n);
                chooseImages();
                setTimeout(playSound, 1000); //delay start of playback
            }

            function checkChoice(n) {

            }

            function initImageArray() {
                //Use a better way to load the number of images I need (~2-5),
                //rather than filling a large array every time the page is loaded?
                for (var i = 0; i <= nImages; i++) {
                    var iPath = "images/rastrograms/image" + i + ".bmp";
                    imageArray.push(iPath);
                }
                console.log("imageArray has " + imageArray.length + " elements");
            }
            function initSoundArray() {
                for (var i = 0; i <= nImages; i++) {
                    //var iPath = "sounds/" + i + ".mp3"; //TODO
                    //var iPath = "sounds/1.mp3";      //placeholder  
                    var iPath = "sounds/audio-numbers/" + i + ".wav";
                    soundArray.push(iPath);
                }
                console.log("soundArray has " + soundArray.length + " elements");
            }

            function chooseImages() {
                //TODO ensure different pics chosen
                var randomNum1 = Math.floor(Math.random() * imageArray.length);
                document.getElementById("leftPicture").src = imageArray[randomNum1];
                document.getElementById("leftPicture").onclick = function () {
                    imageClickEvent(1)
                };
                var randomNum2 = Math.floor(Math.random() * imageArray.length);
                while (randomNum2 == randomNum1) {
                    randomNum2 = Math.floor(Math.random() * imageArray.length); //ensure both images are never the same
                }
                document.getElementById("rightPicture").src = imageArray[randomNum2];
                document.getElementById("rightPicture").onclick = function () {
                    imageClickEvent(2)
                };

                console.log("load images " + randomNum1 + " and " + randomNum2);
                //pick one of the 2 random numbers to use that sound index
                var picked = Math.random() < 0.5 ? randomNum1 : randomNum2;
                console.log("picking sound " + picked);
                chooseSound(picked);

            }

            function chooseSound(n) {
                document.getElementById("sound1").src = soundArray[n];
            }

            function playSound() {

                var af = document.getElementById("sound1");
                af.volume = 0.2;
                af.play();

            }

            window.onload = start;

            function start() {

                initImageArray();
                initSoundArray();
                chooseImages(); //chooseSound() is called from here
                setTimeout(playSound, 1000); //delay playback

            }
        </script>
    </body>

</html>
